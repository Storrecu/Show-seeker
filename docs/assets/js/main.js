"use strict";const input=document.querySelector(".js-input-search"),btnSearch=document.querySelector(".js-btn-search"),listForm=document.querySelector(".js-form-list"),listFav=document.querySelector(".js-fav-list"),btnDelete=document.querySelector(".js-delete-fav");let favList=[],showsList=[];const defaultUrl="https://api.tvmaze.com/search/shows?q=Simpsons",storedFavorites=JSON.parse(localStorage.getItem("favorites"));storedFavorites?(favList=storedFavorites,renderFavouriteShows(favList)):renderShow();const addToFavourites=()=>{const e=document.querySelectorAll(".js-card");for(const t of e)t.addEventListener("click",handleClickShow)};function loadDefaultShow(){fetch(defaultUrl).then(e=>e.json()).then(e=>{showsList=e,renderShow()})}function renderShow(){let e=input.value;""!==e?fetch("//api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{if(showsList=e,listForm.innerHTML="",0===e.length)listForm.innerHTML="No matches found.Try a diferent show";else{listForm.innerHTML="";for(const e of showsList){let t="";t+=`\n            <li id="${e.show.id}" class="js-card" >\n            <img class="js-card-img" src="${e.show.image?e.show.image.medium:"//via.placeholder.com/210x295/ffffff/666666/?text=TV"}"/> \n            <h2 class="js-card-title">${e.show.name} </h2>`,t+="</li>",listForm.innerHTML+=t}addToFavourites()}}):listForm.innerHTML="Write any show to start"}function renderFavouriteShows(){listFav.innerHTML="";for(const e of favList){let t="";t+=`\n    <li id="${e.show.id}" class="js-fav">\n    <span class="js-fav-cross"> X </span>\n    <img class="js-fav-img" src="${e.show.image?e.show.image.medium:"//via.placeholder.com/210x295/ffffff/666666/?text=TV"}" /> \n    <h2 class="js-fav-title" >${e.show.name}</h2> `,t+="</li>",listFav.innerHTML+=t}}loadDefaultShow(),renderShow();const crossDeleteFavs=()=>{listFav.addEventListener("click",handleClickDelete)};function handleDeleteBtn(){listFav.innerHTML="",favList=[],localStorage.clear()}function handleSearchButton(e){e.preventDefault(),renderShow()}function handleClickShow(e){e.preventDefault();const t=e.currentTarget.id;let s=showsList.find(e=>e.show.id.toString()===t);const n=favList.findIndex(e=>e.show.id===s.show.id),i=e.currentTarget;-1===n?(favList.push(s),i.classList.add("is-favorite")):(favList.splice(n,1),i.classList.remove("is-favorite")),localStorage.setItem("favorites",JSON.stringify(favList)),renderFavouriteShows(favList)}function handleClickDelete(e){const t=e.target.closest(".js-fav").id;if(e.target.classList.contains("js-fav-cross")){const s=favList.findIndex(e=>e.show.id===parseInt(t));-1!==s&&(favList.splice(s,1),localStorage.setItem("favorites",JSON.stringify(favList)),renderFavouriteShows(favList)),e.target.parentElement.remove()}}function handleInput(){listForm.innerHTML=""}listFav.addEventListener("click",handleClickDelete),btnDelete.addEventListener("click",handleDeleteBtn),btnSearch.addEventListener("click",handleSearchButton),input.addEventListener("change",handleInput);