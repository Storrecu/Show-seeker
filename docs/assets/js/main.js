"use strict";const input=document.querySelector(".js-input-search"),btnSearch=document.querySelector(".js-btn-search"),listForm=document.querySelector(".js-form-list"),listFav=document.querySelector(".js-fav-list"),btnDelete=document.querySelector(".js-delete-fav");let favList=[],showsList=[];const storedFavorites=JSON.parse(localStorage.getItem("favorites"));storedFavorites?(favList=storedFavorites,renderFavouriteShows(favList)):renderShow();const addToFavourites=()=>{const e=document.querySelectorAll(".js-card");for(const t of e)t.addEventListener("click",handleClickShow)},renderList=({lists:e,isFavourite:t=!1,classType:s})=>{listForm.innerHTML="";for(const i of e){let e="";e+=`\n            <li id=${i.show.id} class=${s} >\n            <img class="js-card-img" src="${i.show.image?i.show.image.medium:"//via.placeholder.com/210x295/ffffff/666666/?text=TV"}"/> \n            <h2 class="js-card-title">${i.show.name} </h2>`,t&&(e+='<span class="js-fav-cross"> X </span>'),e+="</li>",listForm.innerHTML+=e}};function loadDefaultShow(){fetch("https://api.tvmaze.com/search/shows?q=love").then(e=>e.json()).then(e=>{showsList=e,renderList({lists:showsList,isFavourite:!1,classType:"js-card"})})}function renderShow(){let e=input.value;""!==e?fetch("//api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{showsList=e,listForm.innerHTML="",0===e.length?listForm.innerHTML="No matches found.Try a diferent show":(renderList({lists:showsList,isFavourite:!1,classType:"js-card"}),addToFavourites())}):listForm.innerHTML=loadDefaultShow()}function renderFavouriteShows(){listFav.innerHTML="";for(const e of favList){let t="";t+=`\n    <li id="${e.show.id}" class="js-fav">\n    <span class="js-fav-cross"> X </span>\n    <img class="js-fav-img" src="${e.show.image?e.show.image.medium:"//via.placeholder.com/210x295/ffffff/666666/?text=TV"}" /> \n    <h2 class="js-fav-title" >${e.show.name}</h2> `,t+="</li>",listFav.innerHTML+=t}}renderShow();const crossDeleteFavs=()=>{listFav.addEventListener("click",handleClickDelete)};function handleDeleteBtn(){listFav.innerHTML="",favList=[],localStorage.clear()}function handleSearchButton(e){e.preventDefault(),renderShow()}function handleClickShow(e){e.preventDefault();const t=e.currentTarget.id;let s=showsList.find(e=>e.show.id.toString()===t);const i=favList.findIndex(e=>e.show.id===s.show.id),n=e.currentTarget;-1===i?(favList.push(s),n.classList.add("is-favorite")):(favList.splice(i,1),n.classList.remove("is-favorite")),localStorage.setItem("favorites",JSON.stringify(favList)),renderFavouriteShows(favList)}function handleClickDelete(e){const t=e.target.closest(".js-fav").id;if(e.target.classList.contains("js-fav-cross")){const s=favList.findIndex(e=>e.show.id===parseInt(t));-1!==s&&(favList.splice(s,1),localStorage.setItem("favorites",JSON.stringify(favList)),renderFavouriteShows(favList)),e.target.parentElement.remove()}}function handleInput(){listForm.innerHTML=""}listFav.addEventListener("click",handleClickDelete),btnDelete.addEventListener("click",handleDeleteBtn),btnSearch.addEventListener("click",handleSearchButton),input.addEventListener("change",handleInput);